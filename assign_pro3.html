<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Travel Booking Demo</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Google Font (optional) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --card-radius: 14px;
      --card-shadow: 0 10px 30px rgba(17,24,39,0.08);
      --accent: #0d6efd;
      --muted: #6b7280;
    }
    html,body {
      font-family: 'Inter', system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      background: #f7fafc;
      margin: 0;
      color: #0f172a;
    }

    /* Header */
    .hero {
      background: linear-gradient(90deg, rgba(13,110,253,0.06), transparent);
      padding: 1.4rem 1rem;
      border-bottom: 1px solid rgba(0,0,0,0.04);
    }

    /* Search area */
    .search-row .form-control, .search-row .form-select {
      height: 46px;
      border-radius: 10px;
    }

    /* Destination cards */
    .dest-card {
      background: #fff;
      border-radius: var(--card-radius);
      box-shadow: var(--card-shadow);
      overflow: hidden;
      transition: transform .18s ease, box-shadow .18s ease;
      position: relative;
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    .dest-card:hover {
      transform: translateY(-6px);
      box-shadow: 0 18px 40px rgba(17,24,39,0.12);
    }
    .dest-image {
      height: 160px;
      object-fit: cover;
      width: 100%;
      display: block;
    }
    .dest-body {
      padding: 1rem;
      flex: 1 1 auto;
    }
    .price-badge {
      position: absolute;
      top: 12px;
      right: 12px;
      z-index: 5;
      border-radius: 10px;
      padding: .45rem .6rem;
      font-weight:600;
      background: rgba(255,255,255,0.95);
      box-shadow: 0 6px 16px rgba(2,6,23,0.08);
    }

    /* Details panel (below cards) */
    #detailsPanel {
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 12px;
      background: white;
      box-shadow: var(--card-shadow);
    }

    /* Booking form inside modal: increased inputs spacing */
    .modal-body .form-control, .modal-body .form-select {
      margin-bottom: .65rem;
    }

    /* Responsive: on small screens make images taller */
    @media (max-width: 576px) {
      .dest-image { height: 200px; }
      .search-row .form-control, .search-row .form-select { height: 44px; }
    }
  </style>
</head>
<body>

  <!-- HERO / SEARCH -->
  <header class="hero d-flex align-items-center justify-content-between">
    <div>
      <h3 class="mb-0">TravelExplorer</h3>
      <small class="text-muted">Find & book your next trip</small>
    </div>
    <div style="min-width:320px; max-width:780px; width:48%">
      <form id="searchForm" class="row gx-2 search-row">
        <!-- destination input w/ datalist (autocomplete) -->
        <div class="col-12 col-sm-5">
          <label class="visually-hidden" for="destinationInput">Destination</label>
          <input list="destinationsList" id="destinationInput" class="form-control" placeholder="Where to?" autocomplete="on">
          <datalist id="destinationsList">
            <!-- datalist options will be populated by JS -->
          </datalist>
        </div>

        <!-- date input -->
        <div class="col-6 col-sm-3">
          <label class="visually-hidden" for="departDate">Depart</label>
          <input type="date" id="departDate" class="form-control" aria-label="Departure date">
        </div>

        <!-- range input for max price -->
        <div class="col-6 col-sm-2">
          <label class="visually-hidden" for="priceRange">Max price</label>
          <input type="range" id="priceRange" min="50" max="5000" step="10" value="1500" class="form-range" aria-label="Max price">
          <div class="small text-muted" id="priceRangeVal">$1500</div>
        </div>

        <div class="col-12 col-sm-2 d-grid">
          <button type="submit" class="btn btn-primary">Search</button>
        </div>
      </form>
    </div>
  </header>

  <!-- MAIN CONTENT -->
  <main class="container my-4">
    <div class="row mb-3 align-items-center">
      <div class="col-lg-8">
        <h5 class="mb-0">Popular Destinations <small class="text-muted">({{count}} results)</small></h5>
        <small class="text-muted">Tap a card to view details; click Book to reserve.</small>
      </div>
      <div class="col-lg-4 text-lg-end mt-2 mt-lg-0">
        <!-- badges / filters summary -->
        <span class="badge bg-info text-dark me-1" id="filterBadge">All</span>
        <span class="badge bg-light text-muted">Autocomplete, Date & Range</span>
      </div>
    </div>

    <!-- filter controls: live search and rating slider -->
    <div class="row g-2 mb-3 align-items-center">
      <div class="col-md-6">
        <input id="liveSearch" class="form-control" placeholder="Filter results (city, country, tag) — live" />
      </div>
      <div class="col-md-4 d-flex align-items-center gap-2">
        <label class="mb-0 small text-muted">Min rating</label>
        <input id="ratingRange" type="range" min="1" max="5" step="0.5" value="3" class="form-range" style="width:200px;">
        <div id="ratingVal" class="small text-muted">3.0</div>
      </div>
      <div class="col-md-2 text-end">
        <button id="scrollTopBtn" class="btn btn-outline-secondary btn-sm">↑ Top</button>
      </div>
    </div>

    <!-- DESTINATION GRID -->
    <section id="destGrid" class="row g-3">
      <!-- JS will inject destination cards here -->
    </section>

    <!-- DETAILS PANEL (dynamically filled) -->
    <div id="detailsPanel" class="mt-4" style="display:none;">
      <div class="d-flex justify-content-between align-items-start">
        <div>
          <h4 id="detailsTitle"></h4>
          <div class="text-muted" id="detailsLocation"></div>
        </div>
        <div class="text-end">
          <div><span class="badge bg-success" id="detailsRating"></span></div>
          <div class="mt-2"><strong id="detailsPrice"></strong></div>
        </div>
      </div>
      <hr>
      <p id="detailsDesc"></p>
      <div class="d-flex gap-2">
        <button class="btn btn-primary" id="bookNowBtn">Book Now</button>
        <a href="#" id="morePhotos" class="btn btn-outline-secondary">More Photos</a>
      </div>
    </div>
  </main>

  <!-- BOOKING MODAL -->
  <div class="modal fade" id="bookingModal" tabindex="-1" aria-labelledby="bookingModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <form id="bookingForm" class="modal-content needs-validation" novalidate>
        <div class="modal-header">
          <h5 class="modal-title" id="bookingModalLabel">Book Trip</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <!-- dynamic summary -->
          <div id="bookingSummary" class="mb-3 small text-muted"></div>

          <!-- Form inputs -->
          <label class="form-label">Full name</label>
          <input type="text" id="bookName" class="form-control" required placeholder="Your full name">

          <label class="form-label">Email</label>
          <input type="email" id="bookEmail" class="form-control" required placeholder="you@example.com">

          <label class="form-label">Travel date</label>
          <input type="date" id="bookDate" class="form-control" required>

          <label class="form-label">Seats</label>
          <input type="number" id="bookSeats" class="form-control" min="1" max="10" value="1" required>

          <div class="form-check mt-2">
            <input class="form-check-input" type="checkbox" value="" id="acceptTerms" required>
            <label class="form-check-label small" for="acceptTerms">I confirm the booking details and accept the terms.</label>
          </div>

          <div id="bookingError" class="text-danger small mt-2" style="display:none;"></div>

          <hr>
          <div id="previewArea" style="display:none;">
            <h6>Preview</h6>
            <div id="previewContent" class="small"></div>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" id="previewBtn" class="btn btn-outline-secondary">Preview</button>
          <button type="submit" class="btn btn-primary">Confirm Booking</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Bootstrap & jQuery JS -->
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // ---------- SAMPLE DESTINATIONS DATA ----------
    // In production, fetch from API
    const destinations = [
      {
        id: 'paris',
        title: 'Paris Getaway',
        city: 'Paris',
        country: 'France',
        price: 350,
        rating: 4.7,
        img: 'https://images.unsplash.com/photo-1502602898657-3e91760cbb34?q=80&w=1400&auto=format&fit=crop&ixlib=rb-4.0.3&s=81b2f2a6d0d5d0a8a5fae553a1017f61',
        short: 'Romantic city-break with iconic sights and cafes.',
        desc: 'Enjoy the Eiffel Tower, Louvre, Seine cruises, and world-class cuisine.'
      },
      {
        id: 'goa',
        title: 'Beaches of Goa',
        city: 'Goa',
        country: 'India',
        price: 120,
        rating: 4.3,
        img: 'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?q=80&w=1400&auto=format&fit=crop&ixlib=rb-4.0.3&s=7137e0618f6b4a2f4d6d7d6d204ba0d7',
        short: 'Sunny beaches, vibrant nightlife, and coastal cuisine.',
        desc: 'Relax on golden sands, try water sports, and savor local seafood.'
      },
      {
        id: 'tokyo',
        title: 'Tokyo Explorer',
        city: 'Tokyo',
        country: 'Japan',
        price: 980,
        rating: 4.8,
        img: 'https://images.unsplash.com/photo-1512453979798-5ea266f8880c?q=80&w=1400&auto=format&fit=crop&ixlib=rb-4.0.3&s=03e7f1d6f5f2c7b1bd0d0e5a8a1a3f65',
        short: 'Futuristic metropolis with food, culture & temples.',
        desc: 'Discover Shibuya, ancient shrines, Michelin street food and neon-lit nights.'
      },
      {
        id: 'cape',
        title: 'Cape Town Escape',
        city: 'Cape Town',
        country: 'South Africa',
        price: 650,
        rating: 4.5,
        img: 'https://images.unsplash.com/photo-1505765059047-6f90f8a7b623?q=80&w=1400&auto=format&fit=crop&ixlib=rb-4.0.3&s=9f7c4da1b1e2a1d9f2b7a1c2d3e4f5a6',
        short: 'Dramatic coasts, vineyards and Table Mountain.',
        desc: 'Hike Table Mountain, tour vineyards and enjoy coastal drives.'
      }
    ];

    // ---------- UTILS ----------
    function formatCurrency(n) { return '$' + Number(n).toLocaleString(); }
    function safeText(s){ return String(s || '').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

    // ---------- POPULATE DATALIST (autocomplete) ----------
    const datalist = document.getElementById('destinationsList');
    destinations.forEach(d => {
      const opt = document.createElement('option');
      opt.value = d.city + ', ' + d.country;
      datalist.appendChild(opt);
    });

    // ---------- RENDER DESTINATION CARDS ----------
    function renderGrid(list){
      const grid = document.getElementById('destGrid');
      grid.innerHTML = '';
      if(!list.length){
        grid.innerHTML = '<div class="col-12"><div class="p-3 bg-white rounded text-center">No destinations found</div></div>';
        return;
      }
      list.forEach(dest => {
        const col = document.createElement('div');
        col.className = 'col-12 col-md-6 col-lg-4';
        col.innerHTML = `
          <div class="dest-card h-100" data-id="${dest.id}">
            <div class="price-badge">${formatCurrency(dest.price)}</div>
            <img class="dest-image" src="${dest.img}" alt="${safeText(dest.title)}">
            <div class="dest-body">
              <div class="d-flex justify-content-between align-items-start">
                <div>
                  <h6 class="mb-1">${safeText(dest.title)}</h6>
                  <div class="small text-muted">${safeText(dest.city)}, ${safeText(dest.country)}</div>
                </div>
                <div class="text-end">
                  <span class="badge bg-warning text-dark">${dest.rating}</span>
                </div>
              </div>
              <p class="mt-2 mb-0 small text-muted">${safeText(dest.short)}</p>
              <div class="mt-3 d-flex gap-2">
                <button class="btn btn-sm btn-outline-primary view-details">View</button>
                <button class="btn btn-sm btn-primary ms-auto book-btn">Book</button>
              </div>
            </div>
          </div>
        `;
        grid.appendChild(col);
      });
    }

    // initial render
    renderGrid(destinations);

    // ---------- DYNAMIC DETAILS LOADING ----------
    const detailsPanel = document.getElementById('detailsPanel');
    function showDetailsById(id){
      const d = destinations.find(x => x.id === id);
      if(!d) return;
      $('#detailsTitle').text(d.title);
      $('#detailsLocation').text(d.city + ', ' + d.country);
      $('#detailsRating').text(d.rating);
      $('#detailsPrice').text(formatCurrency(d.price));
      $('#detailsDesc').text(d.desc);
      $('#morePhotos').attr('href', d.img); // placeholder
      $('#bookNowBtn').off('click').on('click', () => openBookingModal(d));
      detailsPanel.style.display = 'block';
      // smooth scroll to details
      $('html,body').animate({ scrollTop: $('#detailsPanel').offset().top - 20 }, 400);
    }

    // Click handlers using event delegation
    $(document).on('click', '.view-details', function(e){
      const id = $(this).closest('.dest-card').data('id');
      showDetailsById(id);
    });

    // clicking card shows details too
    $(document).on('click', '.dest-card', function(e){
      // avoid if button inside was clicked
      if($(e.target).is('button') || $(e.target).closest('button').length) return;
      const id = $(this).data('id');
      showDetailsById(id);
    });

    // ---------- BOOKING FLOW (modal + validation) ----------
    let selectedDest = null;
    const bookingModal = new bootstrap.Modal(document.getElementById('bookingModal'));
    function openBookingModal(dest){
      selectedDest = dest;
      $('#bookingModalLabel').text('Book: ' + dest.title);
      $('#bookingSummary').text(dest.title + ' — ' + dest.city + ', ' + dest.country + ' • ' + formatCurrency(dest.price) + ' per seat');
      // reset form fields
      $('#bookingForm')[0].reset();
      $('#bookingError').hide();
      $('#previewArea').hide();
      // set min date to today
      const today = new Date().toISOString().split('T')[0];
      $('#bookDate').attr('min', today).val(today);
      bookingModal.show();
    }

    // Book button on cards
    $(document).on('click', '.book-btn', function(e){
      e.stopPropagation();
      const id = $(this).closest('.dest-card').data('id');
      const d = destinations.find(x=> x.id === id);
      openBookingModal(d);
    });

    // Preview action
    $('#previewBtn').on('click', function(e){
      e.preventDefault();
      composePreview();
    });

    // Booking validation and submit
    $('#bookingForm').on('submit', function(e){
      e.preventDefault();
      const name = $('#bookName').val().trim();
      const email = $('#bookEmail').val().trim();
      const date = $('#bookDate').val();
      const seats = parseInt($('#bookSeats').val(), 10) || 0;
      const accepted = $('#acceptTerms').is(':checked');

      // basic validation
      if(!name || !email || !date || seats < 1 || !accepted){
        $('#bookingError').text('Please complete all fields and accept the terms.').show();
        return;
      }

      // business rule: booking date can't be before depart date selected in search (if set)
      const departDateVal = $('#departDate').val();
      if(departDateVal && new Date(date) < new Date(departDateVal)){
        $('#bookingError').text('Travel date cannot be before your selected depart date.').show();
        return;
      }

      // success: show a summary and close modal after small delay (demo)
      $('#bookingError').hide();
      $('#bookingError').removeClass('text-danger').addClass('text-success').text('Booking confirmed! Reference: ' + Math.random().toString(36).slice(2,9)).show();
      setTimeout(() => {
        $('#bookingError').hide().removeClass('text-success').addClass('text-danger');
        bookingModal.hide();
        // In production, send data to server here and handle response
        alert('Booking successful — demo only.');
      }, 900);
    });

    // Compose preview of booking
    function composePreview(){
      const name = $('#bookName').val().trim();
      const email = $('#bookEmail').val().trim();
      const date = $('#bookDate').val();
      const seats = $('#bookSeats').val();
      if(!selectedDest){
        $('#bookingError').text('No destination selected.').show();
        return;
      }
      $('#bookingError').hide();
      $('#previewContent').html(`
        <strong>${safeText(selectedDest.title)}</strong><br>
        ${selectedDest.city}, ${selectedDest.country}<br>
        Date: ${safeText(date)}<br>
        Seats: ${safeText(seats)}<br>
        Total: ${formatCurrency(selectedDest.price * (parseInt(seats,10)||1))}
      `);
      $('#previewArea').show();
    }

    // ---------- jQuery SEARCH FILTERING & SMOOTH SCROLL ----------
    function applyFilters(){
      const q = $('#liveSearch').val().trim().toLowerCase();
      const minRating = parseFloat($('#ratingRange').val());
      const maxPrice = parseInt($('#priceRange').val(),10);

      const filtered = destinations.filter(d => {
        const matchesQuery = q === '' ||
          d.title.toLowerCase().includes(q) ||
          d.city.toLowerCase().includes(q) ||
          d.country.toLowerCase().includes(q) ||
          d.short.toLowerCase().includes(q);
        const matchesRating = d.rating >= minRating;
        const matchesPrice = d.price <= maxPrice;
        return matchesQuery && matchesRating && matchesPrice;
      });

      // update badge
      $('#filterBadge').text(`${filtered.length} shown`);
      renderGrid(filtered);
    }

    // live inputs events
    $('#liveSearch').on('input', function(){ applyFilters(); });
    $('#ratingRange').on('input', function(){ $('#ratingVal').text(parseFloat(this.value).toFixed(1)); applyFilters(); });
    $('#priceRange').on('input', function(){ $('#priceRangeVal').text('$' + this.value); applyFilters(); });

    // Search form submit (top)
    $('#searchForm').on('submit', function(e){
      e.preventDefault();
      // if destination name typed and matches exactly a city, scroll to it
      const typed = $('#destinationInput').val().trim().toLowerCase();
      if(typed){
        const found = destinations.find(d => (d.city + ', ' + d.country).toLowerCase() === typed || d.city.toLowerCase() === typed);
        if(found){
          // ensure item exists in current DOM (applyFilters may hide it). If it's filtered out, render it momentarily
          renderGrid([found]);
          // smooth scroll to first card
          setTimeout(()=> {
            const el = $('.dest-card').first();
            $('html,body').animate({scrollTop: el.offset().top - 60}, 400);
          }, 60);
          return;
        }
      }
      // else just apply filters
      applyFilters();
    });

    // Smooth scroll to top button
    $('#scrollTopBtn').on('click', function(){ $('html,body').animate({scrollTop:0}, 400); });

    // keyboard accessibility: Enter key in liveSearch triggers applyFilters
    $('#liveSearch').on('keydown', function(e){ if(e.key === 'Enter'){ e.preventDefault(); applyFilters(); } });

    // initial filter state and UI
    $(function(){
      $('#ratingVal').text($('#ratingRange').val());
      $('#priceRangeVal').text('$' + $('#priceRange').val());
      applyFilters(); // initial render filtered by default values
    });

  </script>
</body>
</html>
